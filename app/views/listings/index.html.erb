<div class="container-fluid">
  <h2>All Listings</h2>
  <hr>
  <div class="row">
    <div class="col-2">
      <h4>Filter By</h4>
      <%= form_tag listings_path, method: :get, id: "item_filtering_form" do %>
        <%#= submit_tag "Refresh", id: "filters_submit", class: "btn btn-primary" %>
        <h6 class="mt-3 mb-1">Category:</h6>
        <% @all_categories.each do |category| %>
          <div class="form-check ml-2">
            <%= check_box_tag "categories[#{category}]", "1",  @categories_to_show.include?(category), onchange: "this.form.submit()", class: "form-check-input" %>
            <%= label_tag "categories[#{category}]", category, class: "form-check-label" %>
          </div>
        <% end %>
        <h6 class="mt-3 mb-1">Fee Units:</h6>
        <% @all_fee_units.each do |fee_unit| %>
          <div class="form-check ml-2">
            <%= check_box_tag "fee_units[#{fee_unit}]", "1",  @fee_units_to_show.include?(fee_unit), onchange: "this.form.submit()", class: "form-check-input" %>
            <%= label_tag "fee_units[#{fee_unit}]", fee_unit, class: "form-check-label" %>
          </div>
        <% end %>
        <h6 class="mt-3 mb-1">Rental Time:</h6>
        <% @all_fee_times.each do |fee_time| %>
          <div class="form-check ml-2">
            <%= check_box_tag "fee_times[#{fee_time}]", "1",  @fee_times_to_show.include?(fee_time), onchange: "this.form.submit()", class: "form-check-input" %>
            <%= label_tag "fee_times[#{fee_time}]", fee_time, class: "form-check-label" %>
          </div>
        <% end %>
        <%= hidden_field_tag :home, "1" %>
      <% end %>
    </div>
    <div class="col-10">
      <div class="row">
        <div class="col-7">
          <%=link_to "Sort Price High to Low", listings_path(sort: "Sort Price High to Low", categories: @filtered_params[:categories], fee_units: @filtered_params[:fee_units], fee_times: @filtered_params[:fee_times], home: "1"), class: "btn btn-primary", style: "margin: 5px"%>
          <%=link_to "Sort Price Low to High", listings_path(sort: "Sort Price Low to High", categories: @filtered_params[:categories], fee_units: @filtered_params[:fee_units], fee_times: @filtered_params[:fee_times], home: "1"), class: "btn btn-primary", style: "margin: 5px"%>
          <%=link_to "Sort by Newest", listings_path(sort: "Sort by Newest", categories: @filtered_params[:categories], fee_units: @filtered_params[:fee_units], fee_times: @filtered_params[:fee_times], home: "1"), class: "btn btn-primary", style: "margin: 5px"%>
          <%=link_to "Sort by Oldest", listings_path(sort: "Sort by Oldest", categories: @filtered_params[:categories], fee_units: @filtered_params[:fee_units], fee_times: @filtered_params[:fee_times], home: "1"), class: "btn btn-primary", style: "margin: 5px"%>
        </div>
        <div class="col-5">
          <%= form_tag listings_path, method: :get do %>
            <%= text_field_tag :search, @filtered_params[:search] %>
            <%= hidden_field_tag :home, "1" %>
            <%= submit_tag "Search" %>
          <% end %>
        </div>
      </div>
      <div class="row">
          <% @listings.each do |listing| %>
            <div class="col-4">
              <div class="card">
                <img class="card-img-top" src="https://dummyimage.com/450x300/dee2e6/6c757d.jpg" alt="Card image cap">
                <div class="card-body">
                  <h5 class="card-title"><%= listing.name %></h5>
                  <p class="card-text">
                    Fee: <%= listing.fee %> <%= listing.fee_unit %> per <%= listing.fee_time %> <br>
                    Item Category: <%= listing.item_category %> <br>
                  </p>
                  <%= link_to "Details", listing_path(listing.id), class:"btn btn-secondary" %>
              </div>
            </div>
          <%end%>
        </div>
      </div>
    </div>
  </div>
</div>